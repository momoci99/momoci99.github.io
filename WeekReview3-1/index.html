<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.17.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>1주일 회고(2/25~3/03) - YKMO 기술 메모</title>
<meta name="description" content="1주일 회고(2019-02-25~2019-03-03)">


  <meta name="author" content="MO YEONG-KWON">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="YKMO 기술 메모">
<meta property="og:title" content="1주일 회고(2/25~3/03)">
<meta property="og:url" content="https://momoci99.github.io//WeekReview3-1/">


  <meta property="og:description" content="1주일 회고(2019-02-25~2019-03-03)">







  <meta property="article:published_time" content="2019-03-04T00:00:00+00:00">





  

  


<link rel="canonical" href="https://momoci99.github.io//WeekReview3-1/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "MO YEONG-KWON",
      "url": "https://momoci99.github.io//"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="YKMO 기술 메모 Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          YKMO 기술 메모
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="https://github.com/momoci99" >About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">MO YEONG-KWON</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>나를 쥐어짜는 즐거움</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Seoul, South Korea</span>
        </li>
      

      
        
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/momoci99" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
          
        
          
        
      

      

      
        <li>
          <a href="mailto:momoci99@gmail.com">
            <meta itemprop="email" content="momoci99@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="1주일 회고(2/25~3/03)">
    <meta itemprop="description" content="1주일 회고(2019-02-25~2019-03-03)">
    <meta itemprop="datePublished" content="March 04, 2019">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">1주일 회고(2/25~3/03)
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <h1 id="1주일-회고2019-02-252019-03-03">1주일 회고(2019-02-25~2019-03-03)</h1>

<ul>
  <li>Clustered Index Scan</li>
  <li>긴급출장</li>
</ul>

<h2 id="clustered-index-scan">Clustered Index Scan</h2>

<p>점심즈음 경주 근무자를 통해서 쿼리의 응답 시간을 개선하는 패치를 진행했다.</p>

<p>정확히는 지난주에 개선한 문서 목록 조회서비스에서 LIKE 쿼리가 추가되면 말도안될만큼 성능 저하가 발생하는것을 확인했다. 운영서버의 DB내의 데이터가 많아지면서 드러난 문제로, 데이터가 적은 개발 서버에서는 3초, 운영서버에서는 무려 40초가 걸리는 상태였다. 실행 계획을 참고하니 <code class="language-plaintext highlighter-rouge">Clustered Index Scan</code> 이 비용의 대부분을 잡아먹고 있었다.즉 인덱싱 안된 컬럼을 조회하려니 테이블 내의 레코드를 모두 검색하게 되고 응답 시간이 늘어지는 문제가 발생하는것.</p>

<p>재미있는점은 LIKE 검색을 하지 않으면 <code class="language-plaintext highlighter-rouge">Clustered Index Scan</code> 이 발생하지 않는다는 것이다. 어떻게 하면 해결할 수 있을까 이리저리 고민하였다.</p>

<ul>
  <li>인덱스를 추가해본다.</li>
  <li>쿼리를 갈아엎는다.</li>
  <li>LIKE 절의 위치를 옮겨본다.</li>
</ul>

<p>우선 인덱스를 추가하는 방법은 옮지 않다고 판단하였다. 딱히 인덱스를 걸만한 컬럼도 없을 뿐더러 LIKE 절의 대상이 되는 컬림이 유동적이였기 때문이였다.</p>

<p>그렇다면 쿼리를 갈아엎는 방법은 어떠한가? 갈아 엎고 새로 작성한다면 좀 나아질지도 모르겠지만 시간이 너무 많이 소요되는 방법이였다.</p>

<p>결국 LIKE 절의 위치를 옮기기로 하였다.</p>

<p>LIKE 절이 붙는 위치를 맨 마지막으로 옮기니(이전에는 중간단계에 위치했었다.) 결과는 성공적이였다. 동일한 결과를 리턴하면서도 <code class="language-plaintext highlighter-rouge">Clustered Index Scan</code>이 발생하지 않는것이였다. DB 지식이 더 풍부했다면 왜 이런일이 발생하는지도 알았을텐데 당시에는 몰랐지만 지금 회고를 쓰니 씁쓸하다. 무튼 LIKE 절을 맨 마지막으로 옮기고 테스트를 거친뒤 경주 근무자를 통해 패치를 진행하기로 하였다. 발주처에서 빨리 개선해 달라고 했기 때문이였다.</p>

<h2 id="긴급-출장">긴급 출장</h2>

<p>코드를 경주 근무자에게 보내고 점심시간에 잠시 서버를 중단시킨후 반영하기로 하였다. 내가 직접하는게 아니라 경주 근무자를 통해서 하는것이지만 매우 간단한 절차이기에 점심을 먹기위해 구내식당으로 향했다. 밥을 먹고나서 회사 근처 까페에서 커피타임을 가지고 있었다. 커피를 느긋하게 즐기려는 찰나 경주 근무자로부터 텔레그램 메시지가 왔다.</p>

<blockquote>
  <p>503 메시지가 뜹니다.</p>
</blockquote>

<p>메시지를 확인하자마자 깊은 한숨이 절로 모르게 튀어나왔다. 바로 본사 사무실의 내 자리로 달려갔다. 그후 경주 근무자와 서버의 여러 사항들을 점검하였다.</p>

<ul>
  <li>IIS는 동작하고 있는가?</li>
  <li>POOL은 살아있는가?</li>
</ul>

<p>확인결과 IIS 자체는 동작하고 있으나 무슨 이유에서인지 POOL이 동작을 하지 않고 있었다. 암만봐도 POOL설정에는 이상이 없었다. 그러다 경주 근무자가 에러 로그를 하나 보내줬다.</p>

<blockquote>
  <p>‘처리되지 않은 예외: System.BadImageFormatException: 프로그램을 잘못된 형식으로 로드하려고 했습니다.</p>
</blockquote>

<p>순간적으로 뭔가가 스쳐지나갔다. 점심시간에 머지한 코드가 제대로 머지가 되었는지 확인하지 않은것이다. 경주 근무지(차단망)에도 별도의 SCM이 존재하기 때문에 코드를 머지-&gt;빌드를 해야하는데 여기서 뭔가가 잘못된것이리라.</p>

<p>경주 근무자를 통해 <code class="language-plaintext highlighter-rouge">Plastic SCM</code>의 브런치 상태를 보아하니 한눈에 뭔가가 잘못된것이 들어왔다. 머지 링크 색상이 초록색이 아닌 보라색이였다.</p>

<p>참고로 Plastic SCM에서 일반적인 머지를 진행했다면 초록색 LINK표시를 하고 <code class="language-plaintext highlighter-rouge">Cherry Pic</code> 머지를 하게되면 보라색 LINK가 표시되는데 이 보라색이 나타난것이였다. (참고로 경주 근무자는 개발자가 아니다.) 머지를 잘못하여 코드가 꼬인것이다. 더이상 경주 근무자를 통해 처리할 수 있는 문제가 아니라는것을 확인하여 팀장님에게 보고후 바로 대전-&gt;경주로 날아갔다. 출발한 시점에서 서버가 다운된지 이미 3시간이 지났기 때문에 상황은 급박했다.</p>

<p>현장 도착후 확인 결과 <code class="language-plaintext highlighter-rouge">Cherry Pic</code>으로 인해 과거 삭제되었던 잘못된 DLL이 들어가버려 POOL이 기동하기위해 DLL을 읽으려는 찰나 잘못된 DLL을 읽게된 것이였다. 서버는 정상화 되었다. 확인에 걸린 시간은 30분. 결국 다음날 아침에 복귀하게 되었다. 끝</p>

<p>지난 한주를 통해 배운것.</p>

<ul>
  <li>쿼리를 생성할때는 최대한 인덱싱된 컬럼을 활용할것.</li>
  <li>불필요한 컬럼은 Select절에 쓰지 말것.</li>
  <li>돌다리도 두들겨보자.</li>
  <li>열심히 공부하자.</li>
</ul>


        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2019-03-04T00:00:00+00:00">March 04, 2019</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=1%EC%A3%BC%EC%9D%BC+%ED%9A%8C%EA%B3%A0%282%2F25~3%2F03%29%20https%3A%2F%2Fmomoci99.github.io%2F%2FWeekReview3-1%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fmomoci99.github.io%2F%2FWeekReview3-1%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fmomoci99.github.io%2F%2FWeekReview3-1%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/WeekReview2-3/" class="pagination--pager" title="1주일 회고(2/18~2/24)
">Previous</a>
    
    
      <a href="/WeekReview3-2/" class="pagination--pager" title="3주 회고(3/4~3/23)
">Next</a>
    
  </nav>

    </div>

    
      <div class="page__comments">
  
  
      <h4 class="page__comments-title">Leave a comment</h4>
      <section id="disqus_thread"></section>
    
</div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/ProjectFinishedRetrospect/" rel="permalink">프로젝트 마무리 회고
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">3개월 전 즈음, 진행하던 webrtc 관련 프로젝트가 다른 부서로 넘어가고 저는 신규 서비스를 개발하는 프로젝트에 참여하게 되었습니다. threejs와 react를 활용한 웹 기반 3d 컨텐츠 제작 및 증강 서비스 개발 업무에 참여하면서 팀, 기술 스택, 업무 방식이 바뀌었고, ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/ThreejsDailyLog/" rel="permalink">React에서 threejs 사용 및 삽질
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">React + Typescript 환경에서 Threejs 사용시 활용했던 라이브러리 및 삽질했던 내용들을 간단하게 정리하였습니다.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2021YearRetrospect/" rel="permalink">2021년 회고
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">순식간에 지나간 2021년이 끝나갑니다. 한해를 돌아보는 회고를 써 봅니다.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/BookReviewSystemDesignChapter2/" rel="permalink">Book review - 가상 면접 사례로 배우는 대규모 시스템 기초  (2장 개략적인 규모 추정)
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">2장 개략적인 규모 추정
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 MO YEONG-KWON. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>







  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-154155002-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-154155002-1', { 'anonymize_ip': false});
</script>






    
  <script>
    var disqus_config = function () {
      this.page.url = "https://momoci99.github.io//WeekReview3-1/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/WeekReview3-1"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://momoci99.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
